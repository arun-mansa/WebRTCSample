/**
 * New node file
 */
var WebSocket = require('ws');


function wock(sendFunction)
{
  function WebSocketMock()
  {
    // We explicitly don't call to WebSocket constructor because we don't want
    // to do a real connection. Instead, we only init its "basic" attributes by
    // hand as it would normally do but without the connection initialization.

    this._socket = null;
    this.bytesReceived = 0;
    this.readyState = null;
    this.supports = {};

    // Emulate the 'open' event
    var self = this;
    setTimeout(function()
    {
      self.emit('open');
    }, 1000);
  };
  WebSocketMock.prototype.__proto__   = WebSocket.prototype;
  WebSocketMock.prototype.constructor = WebSocketMock;

  WebSocketMock.prototype.send = sendFunction;
  WebSocketMock.prototype.close = function(){};

  return WebSocketMock;
};


module.exports = wock;
